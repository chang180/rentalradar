# DEV-27: é€²éš AI åŠŸèƒ½é–‹ç™¼æŒ‡å¼•

## ğŸ“‹ ä»»å‹™æ¦‚è¿°

**ä»»å‹™åç¨±**: DEV-27: Advanced AI Features  
**å„ªå…ˆç´š**: ä¸­  
**ç‹€æ…‹**: ğŸ“‹ å¾…é–‹å§‹  
**ç›®æ¨™**: åŸºæ–¼çœŸå¯¦è³‡æ–™çš„æ™ºæ…§åŒ–åŠŸèƒ½é–‹ç™¼  
**é ä¼°æ™‚é–“**: 3-4 å¤©  

## ğŸ¯ ä¸»è¦ç›®æ¨™

åŸºæ–¼å·²æ”¶é›†çš„çœŸå¯¦æ”¿åºœç§Ÿè³ƒè³‡æ–™ï¼Œé–‹ç™¼é€²éš AI åŠŸèƒ½ï¼Œæä¾›æ™ºæ…§åŒ–çš„ç§Ÿè³ƒå¸‚å ´åˆ†æå’Œé æ¸¬èƒ½åŠ›ã€‚

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½éœ€æ±‚

### 1. ç§Ÿé‡‘é æ¸¬æ¨¡å‹è¨“ç·´ ğŸ¤–
- **åŸºæ–¼çœŸå¯¦è³‡æ–™çš„æ©Ÿå™¨å­¸ç¿’æ¨¡å‹**
- **å¤šè®Šæ•¸é æ¸¬æ¼”ç®—æ³•**
- **æ™‚é–“åºåˆ—åˆ†æ**
- **å€åŸŸç‰¹å¾µå·¥ç¨‹**

### 2. å€‹äººåŒ–æ¨è–¦æ¼”ç®—æ³• ğŸ¯
- **ä½¿ç”¨è€…è¡Œç‚ºåˆ†æ**
- **åå¥½å­¸ç¿’ç³»çµ±**
- **æ™ºæ…§æ¨è–¦å¼•æ“**
- **A/B æ¸¬è©¦æ¡†æ¶**

### 3. å¸‚å ´ç•°å¸¸æª¢æ¸¬ç³»çµ± ğŸš¨
- **ç•°å¸¸æ¨¡å¼è­˜åˆ¥**
- **åƒ¹æ ¼ç•°å¸¸æª¢æ¸¬**
- **å¸‚å ´æ³¢å‹•é è­¦**
- **å³æ™‚è­¦å ±ç³»çµ±**

### 4. æŠ•è³‡é¢¨éšªè©•ä¼° ğŸ“Š
- **é¢¨éšªé‡åŒ–æ¨¡å‹**
- **æŠ•è³‡å›å ±é æ¸¬**
- **é¢¨éšªè©•ç´šç³»çµ±**
- **æŠ•è³‡å»ºè­°ç”Ÿæˆ**

### 5. æ™‚é–“åºåˆ—åˆ†æ â°
- **è¶¨å‹¢é æ¸¬**
- **å­£ç¯€æ€§åˆ†æ**
- **é€±æœŸæ€§æ¨¡å¼è­˜åˆ¥**
- **é•·æœŸè¶¨å‹¢é æ¸¬**

### 6. æ©Ÿå™¨å­¸ç¿’æ¨¡å‹å„ªåŒ– ğŸ”§
- **æ¨¡å‹æ•ˆèƒ½ç›£æ§**
- **è‡ªå‹•é‡è¨“ç·´**
- **è¶…åƒæ•¸å„ªåŒ–**
- **æ¨¡å‹ç‰ˆæœ¬ç®¡ç†**

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### å¾Œç«¯æ¶æ§‹
```
app/
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ AIModelTrainingService.php      # AI æ¨¡å‹è¨“ç·´æœå‹™
â”‚   â”œâ”€â”€ PredictionService.php           # é æ¸¬æœå‹™
â”‚   â”œâ”€â”€ RecommendationEngine.php       # æ¨è–¦å¼•æ“
â”‚   â”œâ”€â”€ AnomalyDetectionService.php     # ç•°å¸¸æª¢æ¸¬æœå‹™
â”‚   â”œâ”€â”€ RiskAssessmentService.php       # é¢¨éšªè©•ä¼°æœå‹™
â”‚   â”œâ”€â”€ TimeSeriesAnalyzer.php          # æ™‚é–“åºåˆ—åˆ†æå™¨
â”‚   â””â”€â”€ ModelOptimizationService.php    # æ¨¡å‹å„ªåŒ–æœå‹™
â”œâ”€â”€ Models/
â”‚   â”œâ”€â”€ Prediction.php                  # é æ¸¬çµæœæ¨¡å‹
â”‚   â”œâ”€â”€ Recommendation.php             # æ¨è–¦è¨˜éŒ„æ¨¡å‹
â”‚   â”œâ”€â”€ Anomaly.php                     # ç•°å¸¸è¨˜éŒ„æ¨¡å‹
â”‚   â””â”€â”€ RiskAssessment.php              # é¢¨éšªè©•ä¼°æ¨¡å‹
â”œâ”€â”€ Http/Controllers/
â”‚   â”œâ”€â”€ AIPredictionController.php      # AI é æ¸¬æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ RecommendationController.php    # æ¨è–¦æ§åˆ¶å™¨
â”‚   â””â”€â”€ RiskAssessmentController.php   # é¢¨éšªè©•ä¼°æ§åˆ¶å™¨
â””â”€â”€ Console/Commands/
    â”œâ”€â”€ TrainPredictionModel.php        # è¨“ç·´é æ¸¬æ¨¡å‹å‘½ä»¤
    â”œâ”€â”€ GenerateRecommendations.php     # ç”Ÿæˆæ¨è–¦å‘½ä»¤
    â””â”€â”€ AnalyzeMarketAnomalies.php      # åˆ†æå¸‚å ´ç•°å¸¸å‘½ä»¤
```

### å‰ç«¯æ¶æ§‹
```
resources/js/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ai/
â”‚   â”‚   â”œâ”€â”€ PredictionChart.tsx         # é æ¸¬åœ–è¡¨çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ RecommendationCard.tsx      # æ¨è–¦å¡ç‰‡çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ AnomalyAlert.tsx            # ç•°å¸¸è­¦å ±çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ RiskIndicator.tsx           # é¢¨éšªæŒ‡æ¨™çµ„ä»¶
â”‚   â”‚   â””â”€â”€ ModelPerformance.tsx        # æ¨¡å‹æ•ˆèƒ½çµ„ä»¶
â”‚   â””â”€â”€ analytics/
â”‚       â”œâ”€â”€ TimeSeriesChart.tsx         # æ™‚é–“åºåˆ—åœ–è¡¨
â”‚       â”œâ”€â”€ CorrelationMatrix.tsx       # ç›¸é—œæ€§çŸ©é™£
â”‚       â””â”€â”€ FeatureImportance.tsx       # ç‰¹å¾µé‡è¦æ€§
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ AIDashboard.tsx                 # AI å„€è¡¨æ¿é é¢
â”‚   â”œâ”€â”€ Predictions.tsx                 # é æ¸¬é é¢
â”‚   â”œâ”€â”€ Recommendations.tsx              # æ¨è–¦é é¢
â”‚   â””â”€â”€ RiskAnalysis.tsx                # é¢¨éšªåˆ†æé é¢
â””â”€â”€ services/
    â”œâ”€â”€ aiService.ts                    # AI æœå‹™
    â”œâ”€â”€ predictionService.ts            # é æ¸¬æœå‹™
    â””â”€â”€ recommendationService.ts        # æ¨è–¦æœå‹™
```

## ğŸ“Š è³‡æ–™æµç¨‹è¨­è¨ˆ

### 1. è³‡æ–™æº–å‚™éšæ®µ
```mermaid
graph TD
    A[æ”¿åºœç§Ÿè³ƒè³‡æ–™] --> B[è³‡æ–™æ¸…ç†èˆ‡æ¨™æº–åŒ–]
    B --> C[ç‰¹å¾µå·¥ç¨‹]
    C --> D[è³‡æ–™åˆ†å‰²]
    D --> E[è¨“ç·´é›†/æ¸¬è©¦é›†/é©—è­‰é›†]
```

### 2. æ¨¡å‹è¨“ç·´æµç¨‹
```mermaid
graph TD
    A[è¨“ç·´è³‡æ–™] --> B[æ¨¡å‹é¸æ“‡]
    B --> C[è¶…åƒæ•¸èª¿å„ª]
    C --> D[æ¨¡å‹è¨“ç·´]
    D --> E[æ¨¡å‹é©—è­‰]
    E --> F[æ¨¡å‹éƒ¨ç½²]
    F --> G[æ•ˆèƒ½ç›£æ§]
```

### 3. é æ¸¬æœå‹™æµç¨‹
```mermaid
graph TD
    A[ä½¿ç”¨è€…è«‹æ±‚] --> B[è³‡æ–™é è™•ç†]
    B --> C[ç‰¹å¾µæå–]
    C --> D[æ¨¡å‹é æ¸¬]
    D --> E[çµæœå¾Œè™•ç†]
    E --> F[å›å‚³é æ¸¬çµæœ]
```

## ğŸ› ï¸ å¯¦ä½œæ­¥é©Ÿ

### éšæ®µ 1: åŸºç¤ AI æœå‹™æ¶æ§‹ (Day 1)

#### 1.1 å»ºç«‹ AI æœå‹™åŸºç¤æ¶æ§‹
```bash
# å»ºç«‹ AI ç›¸é—œæœå‹™
php artisan make:service AIModelTrainingService --no-interaction
php artisan make:service PredictionService --no-interaction
php artisan make:service RecommendationEngine --no-interaction
php artisan make:service AnomalyDetectionService --no-interaction
php artisan make:service RiskAssessmentService --no-interaction
php artisan make:service TimeSeriesAnalyzer --no-interaction
php artisan make:service ModelOptimizationService --no-interaction
```

#### 1.2 å»ºç«‹è³‡æ–™æ¨¡å‹
```bash
# å»ºç«‹ AI ç›¸é—œæ¨¡å‹
php artisan make:model Prediction -m --no-interaction
php artisan make:model Recommendation -m --no-interaction
php artisan make:model Anomaly -m --no-interaction
php artisan make:model RiskAssessment -m --no-interaction
```

#### 1.3 å»ºç«‹æ§åˆ¶å™¨
```bash
# å»ºç«‹ AI æ§åˆ¶å™¨
php artisan make:controller AIPredictionController --no-interaction
php artisan make:controller RecommendationController --no-interaction
php artisan make:controller RiskAssessmentController --no-interaction
```

#### 1.4 å»ºç«‹ Artisan å‘½ä»¤
```bash
# å»ºç«‹ AI å‘½ä»¤
php artisan make:command TrainPredictionModel --no-interaction
php artisan make:command GenerateRecommendations --no-interaction
php artisan make:command AnalyzeMarketAnomalies --no-interaction
```

### éšæ®µ 2: ç§Ÿé‡‘é æ¸¬æ¨¡å‹é–‹ç™¼ (Day 2)

#### 2.1 å¯¦ä½œ AIModelTrainingService
```php
<?php

namespace App\Services;

use App\Models\Property;
use Illuminate\Support\Facades\Log;
use Illuminate\Support\Facades\Cache;

class AIModelTrainingService
{
    public function trainRentPredictionModel(): array
    {
        // 1. è³‡æ–™æº–å‚™
        $trainingData = $this->prepareTrainingData();
        
        // 2. ç‰¹å¾µå·¥ç¨‹
        $features = $this->extractFeatures($trainingData);
        
        // 3. æ¨¡å‹è¨“ç·´
        $model = $this->trainModel($features);
        
        // 4. æ¨¡å‹é©—è­‰
        $accuracy = $this->validateModel($model, $features);
        
        // 5. å„²å­˜æ¨¡å‹
        $this->saveModel($model);
        
        return [
            'status' => 'success',
            'accuracy' => $accuracy,
            'model_version' => $this->getModelVersion(),
            'training_samples' => count($trainingData)
        ];
    }
    
    private function prepareTrainingData(): array
    {
        return Property::with(['location'])
            ->whereNotNull('latitude')
            ->whereNotNull('longitude')
            ->whereNotNull('rent_price')
            ->get()
            ->toArray();
    }
    
    private function extractFeatures(array $data): array
    {
        $features = [];
        
        foreach ($data as $property) {
            $features[] = [
                'area' => $property['area'] ?? 0,
                'rooms' => $property['rooms'] ?? 0,
                'latitude' => $property['latitude'],
                'longitude' => $property['longitude'],
                'district' => $this->encodeDistrict($property['district'] ?? ''),
                'property_type' => $this->encodePropertyType($property['property_type'] ?? ''),
                'floor' => $property['floor'] ?? 0,
                'age' => $this->calculateAge($property['build_year'] ?? null),
                'nearby_facilities' => $this->countNearbyFacilities($property),
                'transport_accessibility' => $this->calculateTransportScore($property)
            ];
        }
        
        return $features;
    }
    
    private function trainModel(array $features): object
    {
        // å¯¦ä½œæ©Ÿå™¨å­¸ç¿’æ¨¡å‹è¨“ç·´
        // å¯ä»¥ä½¿ç”¨ PHP-ML æˆ–å…¶ä»– ML åº«
        return $this->implementMLModel($features);
    }
    
    private function validateModel(object $model, array $features): float
    {
        // å¯¦ä½œæ¨¡å‹é©—è­‰é‚è¼¯
        return $this->calculateAccuracy($model, $features);
    }
}
```

#### 2.2 å¯¦ä½œ PredictionService
```php
<?php

namespace App\Services;

use App\Models\Property;
use App\Models\Prediction;
use Illuminate\Support\Facades\Cache;

class PredictionService
{
    public function predictRentPrice(array $propertyData): array
    {
        // 1. è¼‰å…¥è¨“ç·´å¥½çš„æ¨¡å‹
        $model = $this->loadModel();
        
        // 2. ç‰¹å¾µé è™•ç†
        $features = $this->preprocessFeatures($propertyData);
        
        // 3. åŸ·è¡Œé æ¸¬
        $prediction = $this->executePrediction($model, $features);
        
        // 4. å„²å­˜é æ¸¬çµæœ
        $this->savePrediction($propertyData, $prediction);
        
        return [
            'predicted_price' => $prediction['price'],
            'confidence' => $prediction['confidence'],
            'factors' => $prediction['factors'],
            'model_version' => $this->getModelVersion()
        ];
    }
    
    public function getMarketTrends(string $district = null): array
    {
        $cacheKey = "market_trends_{$district}";
        
        return Cache::remember($cacheKey, 3600, function () use ($district) {
            return $this->analyzeMarketTrends($district);
        });
    }
    
    private function loadModel(): object
    {
        // è¼‰å…¥è¨“ç·´å¥½çš„æ¨¡å‹
        return $this->loadTrainedModel();
    }
    
    private function preprocessFeatures(array $data): array
    {
        // ç‰¹å¾µé è™•ç†é‚è¼¯
        return $this->normalizeFeatures($data);
    }
    
    private function executePrediction(object $model, array $features): array
    {
        // åŸ·è¡Œé æ¸¬é‚è¼¯
        return $model->predict($features);
    }
}
```

### éšæ®µ 3: æ¨è–¦ç³»çµ±é–‹ç™¼ (Day 2-3)

#### 3.1 å¯¦ä½œ RecommendationEngine
```php
<?php

namespace App\Services;

use App\Models\User;
use App\Models\Property;
use App\Models\Recommendation;
use Illuminate\Support\Facades\Cache;

class RecommendationEngine
{
    public function generatePersonalizedRecommendations(User $user, int $limit = 10): array
    {
        // 1. åˆ†æä½¿ç”¨è€…è¡Œç‚º
        $userProfile = $this->analyzeUserBehavior($user);
        
        // 2. è¨ˆç®—ç›¸ä¼¼åº¦
        $similarProperties = $this->findSimilarProperties($userProfile);
        
        // 3. ç”Ÿæˆæ¨è–¦
        $recommendations = $this->generateRecommendations($userProfile, $similarProperties, $limit);
        
        // 4. å„²å­˜æ¨è–¦è¨˜éŒ„
        $this->saveRecommendations($user, $recommendations);
        
        return $recommendations;
    }
    
    public function getCollaborativeRecommendations(User $user): array
    {
        // å”åŒéæ¿¾æ¨è–¦
        return $this->implementCollaborativeFiltering($user);
    }
    
    public function getContentBasedRecommendations(User $user): array
    {
        // å…§å®¹åŸºç¤æ¨è–¦
        return $this->implementContentBasedFiltering($user);
    }
    
    private function analyzeUserBehavior(User $user): array
    {
        // åˆ†æä½¿ç”¨è€…è¡Œç‚ºæ¨¡å¼
        return [
            'preferred_districts' => $this->getPreferredDistricts($user),
            'price_range' => $this->getPriceRange($user),
            'property_types' => $this->getPreferredPropertyTypes($user),
            'search_patterns' => $this->analyzeSearchPatterns($user)
        ];
    }
    
    private function findSimilarProperties(array $userProfile): array
    {
        // æ‰¾åˆ°ç›¸ä¼¼å±¬æ€§
        return Property::where(function ($query) use ($userProfile) {
            if (!empty($userProfile['preferred_districts'])) {
                $query->whereIn('district', $userProfile['preferred_districts']);
            }
            if (!empty($userProfile['property_types'])) {
                $query->whereIn('property_type', $userProfile['property_types']);
            }
            if (!empty($userProfile['price_range'])) {
                $query->whereBetween('rent_price', $userProfile['price_range']);
            }
        })->get()->toArray();
    }
}
```

### éšæ®µ 4: ç•°å¸¸æª¢æ¸¬ç³»çµ± (Day 3)

#### 4.1 å¯¦ä½œ AnomalyDetectionService
```php
<?php

namespace App\Services;

use App\Models\Property;
use App\Models\Anomaly;
use Illuminate\Support\Facades\Log;

class AnomalyDetectionService
{
    public function detectPriceAnomalies(): array
    {
        $anomalies = [];
        
        // 1. çµ±è¨ˆåˆ†æç•°å¸¸æª¢æ¸¬
        $statisticalAnomalies = $this->detectStatisticalAnomalies();
        
        // 2. æ©Ÿå™¨å­¸ç¿’ç•°å¸¸æª¢æ¸¬
        $mlAnomalies = $this->detectMLAnomalies();
        
        // 3. æ™‚é–“åºåˆ—ç•°å¸¸æª¢æ¸¬
        $timeSeriesAnomalies = $this->detectTimeSeriesAnomalies();
        
        $anomalies = array_merge($statisticalAnomalies, $mlAnomalies, $timeSeriesAnomalies);
        
        // 4. å„²å­˜ç•°å¸¸è¨˜éŒ„
        $this->saveAnomalies($anomalies);
        
        return $anomalies;
    }
    
    public function detectMarketAnomalies(): array
    {
        // å¸‚å ´ç•°å¸¸æª¢æ¸¬
        return $this->analyzeMarketAnomalies();
    }
    
    private function detectStatisticalAnomalies(): array
    {
        $anomalies = [];
        
        // Z-score ç•°å¸¸æª¢æ¸¬
        $zScoreAnomalies = $this->detectZScoreAnomalies();
        
        // IQR ç•°å¸¸æª¢æ¸¬
        $iqrAnomalies = $this->detectIQRAnomalies();
        
        return array_merge($zScoreAnomalies, $iqrAnomalies);
    }
    
    private function detectMLAnomalies(): array
    {
        // ä½¿ç”¨æ©Ÿå™¨å­¸ç¿’æ¨¡å‹æª¢æ¸¬ç•°å¸¸
        return $this->implementMLAnomalyDetection();
    }
    
    private function detectTimeSeriesAnomalies(): array
    {
        // æ™‚é–“åºåˆ—ç•°å¸¸æª¢æ¸¬
        return $this->implementTimeSeriesAnomalyDetection();
    }
}
```

### éšæ®µ 5: é¢¨éšªè©•ä¼°ç³»çµ± (Day 3-4)

#### 5.1 å¯¦ä½œ RiskAssessmentService
```php
<?php

namespace App\Services;

use App\Models\Property;
use App\Models\RiskAssessment;
use Illuminate\Support\Facades\Cache;

class RiskAssessmentService
{
    public function assessInvestmentRisk(array $propertyData): array
    {
        // 1. å¸‚å ´é¢¨éšªè©•ä¼°
        $marketRisk = $this->assessMarketRisk($propertyData);
        
        // 2. å€åŸŸé¢¨éšªè©•ä¼°
        $locationRisk = $this->assessLocationRisk($propertyData);
        
        // 3. è²¡å‹™é¢¨éšªè©•ä¼°
        $financialRisk = $this->assessFinancialRisk($propertyData);
        
        // 4. ç¶œåˆé¢¨éšªè©•åˆ†
        $overallRisk = $this->calculateOverallRisk($marketRisk, $locationRisk, $financialRisk);
        
        // 5. å„²å­˜é¢¨éšªè©•ä¼°
        $this->saveRiskAssessment($propertyData, $overallRisk);
        
        return [
            'overall_risk_score' => $overallRisk['score'],
            'risk_level' => $overallRisk['level'],
            'market_risk' => $marketRisk,
            'location_risk' => $locationRisk,
            'financial_risk' => $financialRisk,
            'recommendations' => $overallRisk['recommendations']
        ];
    }
    
    public function getRiskTrends(string $district = null): array
    {
        $cacheKey = "risk_trends_{$district}";
        
        return Cache::remember($cacheKey, 7200, function () use ($district) {
            return $this->analyzeRiskTrends($district);
        });
    }
    
    private function assessMarketRisk(array $propertyData): array
    {
        // å¸‚å ´é¢¨éšªè©•ä¼°é‚è¼¯
        return [
            'price_volatility' => $this->calculatePriceVolatility($propertyData),
            'market_trend' => $this->analyzeMarketTrend($propertyData),
            'competition_level' => $this->assessCompetitionLevel($propertyData)
        ];
    }
    
    private function assessLocationRisk(array $propertyData): array
    {
        // å€åŸŸé¢¨éšªè©•ä¼°é‚è¼¯
        return [
            'transport_accessibility' => $this->assessTransportAccess($propertyData),
            'facility_availability' => $this->assessFacilityAvailability($propertyData),
            'safety_score' => $this->calculateSafetyScore($propertyData)
        ];
    }
    
    private function assessFinancialRisk(array $propertyData): array
    {
        // è²¡å‹™é¢¨éšªè©•ä¼°é‚è¼¯
        return [
            'rental_yield' => $this->calculateRentalYield($propertyData),
            'price_to_income_ratio' => $this->calculatePriceToIncomeRatio($propertyData),
            'affordability_index' => $this->calculateAffordabilityIndex($propertyData)
        ];
    }
}
```

### éšæ®µ 6: æ™‚é–“åºåˆ—åˆ†æ (Day 4)

#### 6.1 å¯¦ä½œ TimeSeriesAnalyzer
```php
<?php

namespace App\Services;

use App\Models\Property;
use Illuminate\Support\Facades\Cache;

class TimeSeriesAnalyzer
{
    public function analyzeRentTrends(string $district = null, int $months = 12): array
    {
        $cacheKey = "rent_trends_{$district}_{$months}";
        
        return Cache::remember($cacheKey, 3600, function () use ($district, $months) {
            return $this->performTrendAnalysis($district, $months);
        });
    }
    
    public function predictFutureTrends(string $district = null, int $forecastMonths = 6): array
    {
        // æ™‚é–“åºåˆ—é æ¸¬
        return $this->implementTimeSeriesForecasting($district, $forecastMonths);
    }
    
    public function detectSeasonalPatterns(string $district = null): array
    {
        // å­£ç¯€æ€§æ¨¡å¼æª¢æ¸¬
        return $this->analyzeSeasonalPatterns($district);
    }
    
    private function performTrendAnalysis(string $district = null, int $months): array
    {
        // è¶¨å‹¢åˆ†æé‚è¼¯
        $data = $this->getHistoricalData($district, $months);
        
        return [
            'trend_direction' => $this->calculateTrendDirection($data),
            'trend_strength' => $this->calculateTrendStrength($data),
            'seasonal_components' => $this->extractSeasonalComponents($data),
            'cyclical_patterns' => $this->identifyCyclicalPatterns($data)
        ];
    }
    
    private function getHistoricalData(string $district = null, int $months): array
    {
        $query = Property::where('created_at', '>=', now()->subMonths($months));
        
        if ($district) {
            $query->where('district', $district);
        }
        
        return $query->orderBy('created_at')
            ->get()
            ->groupBy(function ($item) {
                return $item->created_at->format('Y-m');
            })
            ->map(function ($group) {
                return $group->avg('rent_price');
            })
            ->toArray();
    }
}
```

### éšæ®µ 7: æ¨¡å‹å„ªåŒ–ç³»çµ± (Day 4)

#### 7.1 å¯¦ä½œ ModelOptimizationService
```php
<?php

namespace App\Services;

use Illuminate\Support\Facades\Log;
use Illuminate\Support\Facades\Cache;

class ModelOptimizationService
{
    public function optimizeModelPerformance(): array
    {
        // 1. æ•ˆèƒ½ç›£æ§
        $performance = $this->monitorModelPerformance();
        
        // 2. è¶…åƒæ•¸å„ªåŒ–
        $optimizedParams = $this->optimizeHyperparameters();
        
        // 3. ç‰¹å¾µé¸æ“‡å„ªåŒ–
        $featureOptimization = $this->optimizeFeatureSelection();
        
        // 4. æ¨¡å‹é‡è¨“ç·´
        $retrainResult = $this->retrainModel($optimizedParams, $featureOptimization);
        
        return [
            'performance_improvement' => $performance,
            'optimized_parameters' => $optimizedParams,
            'feature_optimization' => $featureOptimization,
            'retrain_result' => $retrainResult
        ];
    }
    
    public function autoRetrainModel(): array
    {
        // è‡ªå‹•é‡è¨“ç·´é‚è¼¯
        return $this->implementAutoRetraining();
    }
    
    public function getModelPerformanceMetrics(): array
    {
        // æ¨¡å‹æ•ˆèƒ½æŒ‡æ¨™
        return $this->calculatePerformanceMetrics();
    }
    
    private function monitorModelPerformance(): array
    {
        // æ•ˆèƒ½ç›£æ§é‚è¼¯
        return [
            'accuracy' => $this->getModelAccuracy(),
            'precision' => $this->getModelPrecision(),
            'recall' => $this->getModelRecall(),
            'f1_score' => $this->getModelF1Score(),
            'response_time' => $this->getModelResponseTime()
        ];
    }
    
    private function optimizeHyperparameters(): array
    {
        // è¶…åƒæ•¸å„ªåŒ–é‚è¼¯
        return $this->implementHyperparameterOptimization();
    }
}
```

## ğŸ¨ å‰ç«¯å¯¦ä½œ

### 1. AI å„€è¡¨æ¿çµ„ä»¶
```tsx
// resources/js/components/ai/PredictionChart.tsx
import React from 'react';
import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';

interface PredictionChartProps {
  data: Array<{
    date: string;
    actual: number;
    predicted: number;
  }>;
}

export default function PredictionChart({ data }: PredictionChartProps) {
  return (
    <div className="bg-white p-6 rounded-lg shadow-lg">
      <h3 className="text-lg font-semibold mb-4">ç§Ÿé‡‘é æ¸¬è¶¨å‹¢</h3>
      <ResponsiveContainer width="100%" height={300}>
        <LineChart data={data}>
          <CartesianGrid strokeDasharray="3 3" />
          <XAxis dataKey="date" />
          <YAxis />
          <Tooltip />
          <Line 
            type="monotone" 
            dataKey="actual" 
            stroke="#3b82f6" 
            strokeWidth={2}
            name="å¯¦éš›åƒ¹æ ¼"
          />
          <Line 
            type="monotone" 
            dataKey="predicted" 
            stroke="#ef4444" 
            strokeWidth={2}
            strokeDasharray="5 5"
            name="é æ¸¬åƒ¹æ ¼"
          />
        </LineChart>
      </ResponsiveContainer>
    </div>
  );
}
```

### 2. æ¨è–¦ç³»çµ±çµ„ä»¶
```tsx
// resources/js/components/ai/RecommendationCard.tsx
import React from 'react';
import { Link } from '@inertiajs/react';

interface RecommendationCardProps {
  recommendation: {
    id: number;
    title: string;
    price: number;
    district: string;
    score: number;
    reasons: string[];
  };
}

export default function RecommendationCard({ recommendation }: RecommendationCardProps) {
  return (
    <div className="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
      <div className="flex justify-between items-start mb-4">
        <h3 className="text-lg font-semibold">{recommendation.title}</h3>
        <span className="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm">
          æ¨è–¦åº¦: {recommendation.score}%
        </span>
      </div>
      
      <div className="space-y-2 mb-4">
        <p className="text-2xl font-bold text-green-600">
          ${recommendation.price.toLocaleString()}
        </p>
        <p className="text-gray-600">{recommendation.district}</p>
      </div>
      
      <div className="mb-4">
        <h4 className="font-medium text-gray-700 mb-2">æ¨è–¦ç†ç”±:</h4>
        <ul className="space-y-1">
          {recommendation.reasons.map((reason, index) => (
            <li key={index} className="text-sm text-gray-600 flex items-center">
              <span className="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>
              {reason}
            </li>
          ))}
        </ul>
      </div>
      
      <Link
        href={`/properties/${recommendation.id}`}
        className="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors text-center block"
      >
        æŸ¥çœ‹è©³æƒ…
      </Link>
    </div>
  );
}
```

### 3. é¢¨éšªè©•ä¼°çµ„ä»¶
```tsx
// resources/js/components/ai/RiskIndicator.tsx
import React from 'react';

interface RiskIndicatorProps {
  riskScore: number;
  riskLevel: string;
  factors: {
    market: number;
    location: number;
    financial: number;
  };
}

export default function RiskIndicator({ riskScore, riskLevel, factors }: RiskIndicatorProps) {
  const getRiskColor = (level: string) => {
    switch (level) {
      case 'ä½é¢¨éšª': return 'text-green-600 bg-green-100';
      case 'ä¸­é¢¨éšª': return 'text-yellow-600 bg-yellow-100';
      case 'é«˜é¢¨éšª': return 'text-red-600 bg-red-100';
      default: return 'text-gray-600 bg-gray-100';
    }
  };

  return (
    <div className="bg-white p-6 rounded-lg shadow-lg">
      <h3 className="text-lg font-semibold mb-4">æŠ•è³‡é¢¨éšªè©•ä¼°</h3>
      
      <div className="mb-6">
        <div className="flex justify-between items-center mb-2">
          <span className="text-sm font-medium">ç¶œåˆé¢¨éšªè©•åˆ†</span>
          <span className={`px-3 py-1 rounded-full text-sm font-medium ${getRiskColor(riskLevel)}`}>
            {riskLevel} ({riskScore}/100)
          </span>
        </div>
        <div className="w-full bg-gray-200 rounded-full h-3">
          <div 
            className={`h-3 rounded-full transition-all duration-300 ${
              riskScore <= 30 ? 'bg-green-500' : 
              riskScore <= 70 ? 'bg-yellow-500' : 'bg-red-500'
            }`}
            style={{ width: `${riskScore}%` }}
          ></div>
        </div>
      </div>
      
      <div className="space-y-4">
        <div>
          <div className="flex justify-between items-center mb-1">
            <span className="text-sm font-medium">å¸‚å ´é¢¨éšª</span>
            <span className="text-sm text-gray-600">{factors.market}/100</span>
          </div>
          <div className="w-full bg-gray-200 rounded-full h-2">
            <div 
              className="bg-blue-500 h-2 rounded-full"
              style={{ width: `${factors.market}%` }}
            ></div>
          </div>
        </div>
        
        <div>
          <div className="flex justify-between items-center mb-1">
            <span className="text-sm font-medium">å€åŸŸé¢¨éšª</span>
            <span className="text-sm text-gray-600">{factors.location}/100</span>
          </div>
          <div className="w-full bg-gray-200 rounded-full h-2">
            <div 
              className="bg-purple-500 h-2 rounded-full"
              style={{ width: `${factors.location}%` }}
            ></div>
          </div>
        </div>
        
        <div>
          <div className="flex justify-between items-center mb-1">
            <span className="text-sm font-medium">è²¡å‹™é¢¨éšª</span>
            <span className="text-sm text-gray-600">{factors.financial}/100</span>
          </div>
          <div className="w-full bg-gray-200 rounded-full h-2">
            <div 
              className="bg-orange-500 h-2 rounded-full"
              style={{ width: `${factors.financial}%` }}
            ></div>
          </div>
        </div>
      </div>
    </div>
  );
}
```

## ğŸ§ª æ¸¬è©¦ç­–ç•¥

### 1. å–®å…ƒæ¸¬è©¦
```php
// tests/Unit/AIModelTrainingServiceTest.php
<?php

namespace Tests\Unit;

use Tests\TestCase;
use App\Services\AIModelTrainingService;
use App\Models\Property;
use Illuminate\Foundation\Testing\RefreshDatabase;

class AIModelTrainingServiceTest extends TestCase
{
    use RefreshDatabase;
    
    public function test_can_train_rent_prediction_model()
    {
        // æº–å‚™æ¸¬è©¦è³‡æ–™
        Property::factory()->count(100)->create();
        
        $service = new AIModelTrainingService();
        $result = $service->trainRentPredictionModel();
        
        $this->assertArrayHasKey('status', $result);
        $this->assertArrayHasKey('accuracy', $result);
        $this->assertEquals('success', $result['status']);
        $this->assertGreaterThan(0.7, $result['accuracy']);
    }
    
    public function test_can_extract_features_from_property_data()
    {
        $property = Property::factory()->create([
            'area' => 50,
            'rooms' => 2,
            'latitude' => 25.0330,
            'longitude' => 121.5654,
            'district' => 'ä¸­æ­£å€',
            'property_type' => 'apartment'
        ]);
        
        $service = new AIModelTrainingService();
        $features = $service->extractFeatures([$property->toArray()]);
        
        $this->assertCount(1, $features);
        $this->assertArrayHasKey('area', $features[0]);
        $this->assertArrayHasKey('latitude', $features[0]);
        $this->assertArrayHasKey('longitude', $features[0]);
    }
}
```

### 2. åŠŸèƒ½æ¸¬è©¦
```php
// tests/Feature/AIPredictionTest.php
<?php

namespace Tests\Feature;

use Tests\TestCase;
use App\Models\User;
use App\Models\Property;
use Illuminate\Foundation\Testing\RefreshDatabase;

class AIPredictionTest extends TestCase
{
    use RefreshDatabase;
    
    public function test_can_get_rent_prediction()
    {
        $user = User::factory()->create();
        Property::factory()->count(50)->create();
        
        $response = $this->actingAs($user)
            ->postJson('/api/ai/predict', [
                'area' => 30,
                'rooms' => 1,
                'district' => 'ä¸­æ­£å€',
                'property_type' => 'apartment'
            ]);
        
        $response->assertStatus(200)
            ->assertJsonStructure([
                'predicted_price',
                'confidence',
                'factors',
                'model_version'
            ]);
    }
    
    public function test_can_get_personalized_recommendations()
    {
        $user = User::factory()->create();
        Property::factory()->count(20)->create();
        
        $response = $this->actingAs($user)
            ->getJson('/api/ai/recommendations');
        
        $response->assertStatus(200)
            ->assertJsonStructure([
                'recommendations' => [
                    '*' => [
                        'id',
                        'title',
                        'price',
                        'score',
                        'reasons'
                    ]
                ]
            ]);
    }
}
```

## ğŸ“ˆ æ•ˆèƒ½æŒ‡æ¨™

### 1. æ¨¡å‹æ•ˆèƒ½æŒ‡æ¨™
- **æº–ç¢ºç‡ (Accuracy)**: > 85%
- **ç²¾ç¢ºç‡ (Precision)**: > 80%
- **å¬å›ç‡ (Recall)**: > 75%
- **F1 åˆ†æ•¸**: > 77%
- **éŸ¿æ‡‰æ™‚é–“**: < 500ms

### 2. æ¨è–¦ç³»çµ±æŒ‡æ¨™
- **æ¨è–¦æº–ç¢ºç‡**: > 80%
- **ä½¿ç”¨è€…æ»¿æ„åº¦**: > 4.0/5.0
- **é»æ“Šç‡ (CTR)**: > 15%
- **è½‰æ›ç‡**: > 5%

### 3. ç•°å¸¸æª¢æ¸¬æŒ‡æ¨™
- **æª¢æ¸¬æº–ç¢ºç‡**: > 90%
- **èª¤å ±ç‡**: < 5%
- **æª¢æ¸¬å»¶é²**: < 1 åˆ†é˜

### 4. é¢¨éšªè©•ä¼°æŒ‡æ¨™
- **é¢¨éšªé æ¸¬æº–ç¢ºç‡**: > 85%
- **é¢¨éšªç­‰ç´šä¸€è‡´æ€§**: > 90%
- **æŠ•è³‡å»ºè­°æœ‰æ•ˆæ€§**: > 80%

## ğŸš€ éƒ¨ç½²èˆ‡ç›£æ§

### 1. æ¨¡å‹éƒ¨ç½²
```php
// æ¨¡å‹ç‰ˆæœ¬ç®¡ç†
class ModelVersionManager
{
    public function deployModel(string $version): bool
    {
        // æ¨¡å‹éƒ¨ç½²é‚è¼¯
        return $this->implementModelDeployment($version);
    }
    
    public function rollbackModel(string $version): bool
    {
        // æ¨¡å‹å›æ»¾é‚è¼¯
        return $this->implementModelRollback($version);
    }
}
```

### 2. æ•ˆèƒ½ç›£æ§
```php
// AI æ•ˆèƒ½ç›£æ§
class AIPerformanceMonitor
{
    public function monitorModelPerformance(): array
    {
        return [
            'prediction_accuracy' => $this->getPredictionAccuracy(),
            'recommendation_effectiveness' => $this->getRecommendationEffectiveness(),
            'anomaly_detection_rate' => $this->getAnomalyDetectionRate(),
            'risk_assessment_accuracy' => $this->getRiskAssessmentAccuracy()
        ];
    }
}
```

## ğŸ“‹ æˆåŠŸæ¨™æº–

### 1. æŠ€è¡“æ¨™æº–
- âœ… æ‰€æœ‰ AI æœå‹™æ­£å¸¸é‹ä½œ
- âœ… æ¨¡å‹è¨“ç·´å’Œé æ¸¬åŠŸèƒ½å®Œæ•´
- âœ… æ¨è–¦ç³»çµ±æº–ç¢ºç‡é”æ¨™
- âœ… ç•°å¸¸æª¢æ¸¬ç³»çµ±ç©©å®š
- âœ… é¢¨éšªè©•ä¼°åŠŸèƒ½å¯é 
- âœ… æ™‚é–“åºåˆ—åˆ†ææº–ç¢º

### 2. æ•ˆèƒ½æ¨™æº–
- âœ… é æ¸¬éŸ¿æ‡‰æ™‚é–“ < 500ms
- âœ… æ¨è–¦ç”Ÿæˆæ™‚é–“ < 1s
- âœ… ç•°å¸¸æª¢æ¸¬å»¶é² < 1 åˆ†é˜
- âœ… é¢¨éšªè©•ä¼°æº–ç¢ºç‡ > 85%
- âœ… ç³»çµ±å¯ç”¨æ€§ > 99.5%

### 3. ä½¿ç”¨è€…é«”é©—æ¨™æº–
- âœ… AI åŠŸèƒ½ä»‹é¢ç›´è§€æ˜“ç”¨
- âœ… é æ¸¬çµæœæ¸…æ™°æ˜“æ‡‚
- âœ… æ¨è–¦ç†ç”±å……åˆ†èªªæ˜
- âœ… é¢¨éšªæŒ‡æ¨™è¦–è¦ºåŒ–è‰¯å¥½
- âœ… ç•°å¸¸è­¦å ±åŠæ™‚æœ‰æ•ˆ

## ğŸ”§ ç¶­è­·èˆ‡å„ªåŒ–

### 1. å®šæœŸé‡è¨“ç·´
- **é »ç‡**: æ¯é€±ä¸€æ¬¡
- **è§¸ç™¼æ¢ä»¶**: æ–°è³‡æ–™é‡ > 1000 ç­†
- **æ•ˆèƒ½ä¸‹é™**: æº–ç¢ºç‡ < 80%

### 2. æ¨¡å‹å„ªåŒ–
- **è¶…åƒæ•¸èª¿å„ª**: æ¯æœˆä¸€æ¬¡
- **ç‰¹å¾µå·¥ç¨‹**: æ ¹æ“šæ–°è³‡æ–™èª¿æ•´
- **æ¼”ç®—æ³•å‡ç´š**: å­£åº¦è©•ä¼°

### 3. æ•ˆèƒ½ç›£æ§
- **å³æ™‚ç›£æ§**: æ¨¡å‹æ•ˆèƒ½æŒ‡æ¨™
- **è­¦å ±æ©Ÿåˆ¶**: æ•ˆèƒ½ç•°å¸¸è‡ªå‹•é€šçŸ¥
- **è‡ªå‹•ä¿®å¾©**: å¸¸è¦‹å•é¡Œè‡ªå‹•è™•ç†

## ğŸ“š ç›¸é—œè³‡æº

### 1. æŠ€è¡“æ–‡ä»¶
- [Laravel Machine Learning Integration](https://laravel.com/docs/machine-learning)
- [PHP-ML Documentation](https://php-ml.readthedocs.io/)
- [TensorFlow.js for React](https://www.tensorflow.org/js)

### 2. æ¼”ç®—æ³•åƒè€ƒ
- [Scikit-learn Algorithms](https://scikit-learn.org/stable/supervised_learning.html)
- [Time Series Analysis](https://otexts.com/fpp2/)
- [Recommendation Systems](https://www.oreilly.com/library/view/building-recommender-systems/9781492043276/)

### 3. æœ€ä½³å¯¦è¸
- [MLOps Best Practices](https://ml-ops.org/)
- [Model Monitoring](https://www.oreilly.com/library/view/monitoring-machine-learning/9781098116972/)
- [AI Ethics Guidelines](https://www.partnershiponai.org/)

---

**é–‹ç™¼å®Œæˆå¾Œï¼Œè«‹æ›´æ–° PROGRESS.md ä¸¦æ¨™è¨˜ DEV-27 ç‚ºå·²å®Œæˆç‹€æ…‹ã€‚**
