# Hostinger 共享環境模型部署指南

## 主機環境限制摘要
- **運算資源**：CPU 核心數有限，需避免長時間高負載推論；建議模型推論時間 < 300ms。
- **記憶體配額**：單一 PHP 行程記憶體限制 256MB，需透過串流處理與計量快取控管。
- **檔案系統**：僅允許在  內寫入；禁止使用  以外的全局路徑。
- **背景程序**：不支援常駐 Node/Python 服務，僅能在請求週期內呼叫 CLI。
- **排程任務**：可使用 Hostinger Cron Job，最小間隔 15 分鐘。

## 部署流程
1. **準備建置產物**
   - 於 CI/CD 或本地執行 
> build
> vite build 與 
   INFO  Configuration cached successfully.  。
   - 將  與  保持同步版本。
   - 產出 、 內容並確認權限為 。
2. **同步程式碼**
   - 使用 Git 部署或 SFTP 上傳至 Hostinger 專案根目錄。
   - 確保 、 目錄權限為 ，群組為 。
3. **安裝依賴**
   - 執行 
  [37;44m INFO [39;49m Discovering packages.  

  inertiajs/inertia-laravel [90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m [32;1mDONE[39;22m
  laravel/fortify [90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m [32;1mDONE[39;22m
  laravel/tinker [90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m [32;1mDONE[39;22m
  laravel/wayfinder [90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m [32;1mDONE[39;22m
  nesbot/carbon [90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m [32;1mDONE[39;22m
  nunomaduro/termwind [90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m [32;1mDONE[39;22m
  phiki/phiki [90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m[90m.[39m [32;1mDONE[39;22m。
   - 執行 （Hostinger 必須使用 Node 18+）。
   - 建議預先安裝  至  並更新 。
4. **環境設定**
   - 更新 ：、、。
   - 啟用 Redis 快取：，並設定 。
   - 建議新增  供效能警示使用。
5. **資料遷移與快取**
   - 執行 
   INFO  Nothing to migrate.  。
   - 執行 
   INFO  Configuration cached successfully.  


   INFO  Routes cached successfully.  



   INFO  Blade templates cached successfully.  。
   - 清除舊快取 
   ERROR  Command "model:flush-cache" is not defined. Did you mean one of these?  

  ⇂ model:prune  
  ⇂ model:show  （需自訂指令）。
6. **驗證部署**
   - 呼叫 、 驗證  與 。
   - 使用  確認關鍵 API 測試通過。

## 效能最佳實踐
- 開啟  並設定 ，當推論超出閾值寫入 log。
- 使用 Laravel Cache 儲存聚合結果（TTL 60~120 秒）以減少重複推論。
- 將大量資料聚合改由 PHP 原生計算；Node 腳本僅於測試或批次任務使用。
- 控制 API 回應 payload： 聚合超過 100 筆時改為 cluster 模式。
- 啟用  並設定 ，需搭配部署後重啟 PHP-FPM。

## 常見問題排查
- **記憶體不足**：縮小批次推論尺寸 ()，並檢查  警示。
- **推論逾時**：調整  限制 ()，或預先快取結果。
- **Cron Job 未執行**：確認 Hostinger 排程腳本使用 
   INFO  No scheduled commands are ready to run.  。
- **Node 不可用**：於專案層提供  binary，或改用 PHP 演算法 fallback。

## 上線前檢查清單
- [ ]  全部通過。
- [ ]  已設定生產值並同步 。
- [ ]  已設置輪替機制，避免磁區用量寫爆。
- [ ]  輸出中無高於閾值的警告。
- [ ] 文檔與 README 已更新部署流程。
