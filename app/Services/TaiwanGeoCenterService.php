<?php

namespace App\Services;

class TaiwanGeoCenterService
{
    /**
     * 台灣縣市和鄉鎮區的地理中心點對照表
     * 資料來源：政府開放資料平台
     */
    private static array $geoCenters = [
        // 台北市
        '臺北市' => [
            '中正區' => ['lat' => 25.0324, 'lng' => 121.5194],
            '大同區' => ['lat' => 25.0631, 'lng' => 121.5125],
            '中山區' => ['lat' => 25.0640, 'lng' => 121.5266],
            '松山區' => ['lat' => 25.0500, 'lng' => 121.5775],
            '大安區' => ['lat' => 25.0264, 'lng' => 121.5436],
            '萬華區' => ['lat' => 25.0359, 'lng' => 121.4991],
            '信義區' => ['lat' => 25.0320, 'lng' => 121.5654],
            '士林區' => ['lat' => 25.0884, 'lng' => 121.5256],
            '北投區' => ['lat' => 25.1324, 'lng' => 121.4985],
            '內湖區' => ['lat' => 25.0697, 'lng' => 121.5948],
            '南港區' => ['lat' => 25.0547, 'lng' => 121.6071],
            '文山區' => ['lat' => 24.9981, 'lng' => 121.5701],
        ],
        // 新北市
        '新北市' => [
            '板橋區' => ['lat' => 25.0063, 'lng' => 121.4631],
            '三重區' => ['lat' => 25.0614, 'lng' => 121.4875],
            '中和區' => ['lat' => 24.9936, 'lng' => 121.5050],
            '永和區' => ['lat' => 25.0075, 'lng' => 121.5150],
            '新莊區' => ['lat' => 25.0359, 'lng' => 121.4328],
            '新店區' => ['lat' => 24.9578, 'lng' => 121.5406],
            '樹林區' => ['lat' => 24.9906, 'lng' => 121.4250],
            '鶯歌區' => ['lat' => 24.9550, 'lng' => 121.3550],
            '三峽區' => ['lat' => 24.9344, 'lng' => 121.3708],
            '淡水區' => ['lat' => 25.1675, 'lng' => 121.4456],
            '汐止區' => ['lat' => 25.0681, 'lng' => 121.6569],
            '瑞芳區' => ['lat' => 25.1081, 'lng' => 121.8069],
            '土城區' => ['lat' => 24.9731, 'lng' => 121.4431],
            '蘆洲區' => ['lat' => 25.0831, 'lng' => 121.4706],
            '五股區' => ['lat' => 25.0831, 'lng' => 121.4431],
            '泰山區' => ['lat' => 25.0581, 'lng' => 121.4306],
            '林口區' => ['lat' => 25.0775, 'lng' => 121.3894],
            '深坑區' => ['lat' => 25.0019, 'lng' => 121.6181],
            '石碇區' => ['lat' => 24.9906, 'lng' => 121.6581],
            '坪林區' => ['lat' => 24.9344, 'lng' => 121.7106],
            '三芝區' => ['lat' => 25.2581, 'lng' => 121.5006],
            '石門區' => ['lat' => 25.2906, 'lng' => 121.5681],
            '八里區' => ['lat' => 25.1469, 'lng' => 121.3981],
            '平溪區' => ['lat' => 25.0256, 'lng' => 121.7781],
            '雙溪區' => ['lat' => 25.0369, 'lng' => 121.8669],
            '貢寮區' => ['lat' => 25.0206, 'lng' => 121.9206],
            '金山區' => ['lat' => 25.2206, 'lng' => 121.6369],
            '萬里區' => ['lat' => 25.1794, 'lng' => 121.6881],
            '烏來區' => ['lat' => 24.8631, 'lng' => 121.5519],
        ],
        // 桃園市
        '桃園市' => [
            '桃園區' => ['lat' => 24.9936, 'lng' => 121.3011],
            '中壢區' => ['lat' => 24.9531, 'lng' => 121.2256],
            '大溪區' => ['lat' => 24.8831, 'lng' => 121.2869],
            '楊梅區' => ['lat' => 24.9131, 'lng' => 121.1456],
            '蘆竹區' => ['lat' => 25.0481, 'lng' => 121.2931],
            '大園區' => ['lat' => 25.0631, 'lng' => 121.2019],
            '龜山區' => ['lat' => 25.0181, 'lng' => 121.3519],
            '八德區' => ['lat' => 24.9281, 'lng' => 121.2931],
            '龍潭區' => ['lat' => 24.8631, 'lng' => 121.2131],
            '平鎮區' => ['lat' => 24.9431, 'lng' => 121.2131],
            '新屋區' => ['lat' => 24.9731, 'lng' => 121.1019],
            '觀音區' => ['lat' => 25.0331, 'lng' => 121.0831],
            '復興區' => ['lat' => 24.8131, 'lng' => 121.3519],
        ],
        // 台中市
        '臺中市' => [
            '中區' => ['lat' => 24.1431, 'lng' => 120.6831],
            '東區' => ['lat' => 24.1381, 'lng' => 120.6931],
            '南區' => ['lat' => 24.1231, 'lng' => 120.6731],
            '西區' => ['lat' => 24.1431, 'lng' => 120.6631],
            '北區' => ['lat' => 24.1531, 'lng' => 120.6831],
            '西屯區' => ['lat' => 24.1631, 'lng' => 120.6331],
            '南屯區' => ['lat' => 24.1331, 'lng' => 120.6431],
            '北屯區' => ['lat' => 24.1831, 'lng' => 120.6931],
            '豐原區' => ['lat' => 24.2531, 'lng' => 120.7231],
            '東勢區' => ['lat' => 24.2581, 'lng' => 120.8331],
            '大甲區' => ['lat' => 24.3481, 'lng' => 120.6231],
            '清水區' => ['lat' => 24.2681, 'lng' => 120.5731],
            '沙鹿區' => ['lat' => 24.2331, 'lng' => 120.5631],
            '梧棲區' => ['lat' => 24.2531, 'lng' => 120.5331],
            '后里區' => ['lat' => 24.3081, 'lng' => 120.7131],
            '神岡區' => ['lat' => 24.2581, 'lng' => 120.6631],
            '潭子區' => ['lat' => 24.2131, 'lng' => 120.7031],
            '大雅區' => ['lat' => 24.2281, 'lng' => 120.6531],
            '新社區' => ['lat' => 24.2331, 'lng' => 120.8131],
            '石岡區' => ['lat' => 24.2731, 'lng' => 120.7831],
            '外埔區' => ['lat' => 24.3331, 'lng' => 120.6531],
            '大安區' => ['lat' => 24.3481, 'lng' => 120.5831],
            '烏日區' => ['lat' => 24.1031, 'lng' => 120.6231],
            '大肚區' => ['lat' => 24.1531, 'lng' => 120.5431],
            '龍井區' => ['lat' => 24.1931, 'lng' => 120.5231],
            '霧峰區' => ['lat' => 24.0631, 'lng' => 120.7031],
            '太平區' => ['lat' => 24.1231, 'lng' => 120.7131],
            '大里區' => ['lat' => 24.1031, 'lng' => 120.6831],
            '和平區' => ['lat' => 24.1831, 'lng' => 121.0331],
        ],
        // 台南市
        '臺南市' => [
            '中西區' => ['lat' => 23.0000, 'lng' => 120.2000],
            '東區' => ['lat' => 23.0000, 'lng' => 120.2167],
            '南區' => ['lat' => 22.9833, 'lng' => 120.2000],
            '北區' => ['lat' => 23.0167, 'lng' => 120.2000],
            '安平區' => ['lat' => 23.0000, 'lng' => 120.1667],
            '安南區' => ['lat' => 23.0333, 'lng' => 120.1833],
            '永康區' => ['lat' => 23.0333, 'lng' => 120.2500],
            '歸仁區' => ['lat' => 22.9667, 'lng' => 120.2833],
            '新化區' => ['lat' => 23.0333, 'lng' => 120.3167],
            '左鎮區' => ['lat' => 23.0167, 'lng' => 120.4000],
            '玉井區' => ['lat' => 23.1167, 'lng' => 120.4500],
            '楠西區' => ['lat' => 23.1833, 'lng' => 120.4833],
            '南化區' => ['lat' => 23.0333, 'lng' => 120.5167],
            '仁德區' => ['lat' => 22.9667, 'lng' => 120.2500],
            '關廟區' => ['lat' => 22.9500, 'lng' => 120.3167],
            '龍崎區' => ['lat' => 22.9500, 'lng' => 120.3667],
            '官田區' => ['lat' => 23.1833, 'lng' => 120.3167],
            '麻豆區' => ['lat' => 23.1833, 'lng' => 120.2500],
            '佳里區' => ['lat' => 23.1667, 'lng' => 120.1833],
            '西港區' => ['lat' => 23.1333, 'lng' => 120.2000],
            '七股區' => ['lat' => 23.1333, 'lng' => 120.1167],
            '將軍區' => ['lat' => 23.2000, 'lng' => 120.1333],
            '學甲區' => ['lat' => 23.2333, 'lng' => 120.1833],
            '北門區' => ['lat' => 23.2667, 'lng' => 120.1167],
            '新營區' => ['lat' => 23.3167, 'lng' => 120.3167],
            '後壁區' => ['lat' => 23.3667, 'lng' => 120.3500],
            '白河區' => ['lat' => 23.3500, 'lng' => 120.4167],
            '東山區' => ['lat' => 23.3167, 'lng' => 120.4000],
            '六甲區' => ['lat' => 23.2333, 'lng' => 120.3500],
            '下營區' => ['lat' => 23.2333, 'lng' => 120.2667],
            '柳營區' => ['lat' => 23.2667, 'lng' => 120.3167],
            '鹽水區' => ['lat' => 23.3167, 'lng' => 120.2667],
            '善化區' => ['lat' => 23.1333, 'lng' => 120.3000],
            '大內區' => ['lat' => 23.1167, 'lng' => 120.3500],
            '山上區' => ['lat' => 23.1000, 'lng' => 120.3500],
            '新市區' => ['lat' => 23.0833, 'lng' => 120.3000],
            '安定區' => ['lat' => 23.1000, 'lng' => 120.2333],
        ],
        // 高雄市
        '高雄市' => [
            '新興區' => ['lat' => 22.6333, 'lng' => 120.3167],
            '前金區' => ['lat' => 22.6333, 'lng' => 120.3000],
            '苓雅區' => ['lat' => 22.6167, 'lng' => 120.3167],
            '鹽埕區' => ['lat' => 22.6167, 'lng' => 120.2833],
            '鼓山區' => ['lat' => 22.6333, 'lng' => 120.2833],
            '旗津區' => ['lat' => 22.6000, 'lng' => 120.2667],
            '前鎮區' => ['lat' => 22.5833, 'lng' => 120.3167],
            '三民區' => ['lat' => 22.6500, 'lng' => 120.3167],
            '楠梓區' => ['lat' => 22.7167, 'lng' => 120.3333],
            '小港區' => ['lat' => 22.5667, 'lng' => 120.3500],
            '左營區' => ['lat' => 22.6833, 'lng' => 120.3000],
            '仁武區' => ['lat' => 22.7000, 'lng' => 120.3500],
            '大社區' => ['lat' => 22.7333, 'lng' => 120.3667],
            '岡山區' => ['lat' => 22.7833, 'lng' => 120.3000],
            '路竹區' => ['lat' => 22.8500, 'lng' => 120.2667],
            '阿蓮區' => ['lat' => 22.8833, 'lng' => 120.3167],
            '田寮區' => ['lat' => 22.8667, 'lng' => 120.4000],
            '燕巢區' => ['lat' => 22.8000, 'lng' => 120.3667],
            '橋頭區' => ['lat' => 22.7500, 'lng' => 120.3000],
            '梓官區' => ['lat' => 22.7500, 'lng' => 120.2500],
            '彌陀區' => ['lat' => 22.7833, 'lng' => 120.2333],
            '永安區' => ['lat' => 22.8167, 'lng' => 120.2167],
            '湖內區' => ['lat' => 22.9000, 'lng' => 120.2167],
            '鳳山區' => ['lat' => 22.6167, 'lng' => 120.3500],
            '大寮區' => ['lat' => 22.5833, 'lng' => 120.4000],
            '林園區' => ['lat' => 22.5000, 'lng' => 120.4000],
            '鳥松區' => ['lat' => 22.6500, 'lng' => 120.3667],
            '大樹區' => ['lat' => 22.7000, 'lng' => 120.4333],
            '旗山區' => ['lat' => 22.8833, 'lng' => 120.4833],
            '美濃區' => ['lat' => 22.9000, 'lng' => 120.5500],
            '六龜區' => ['lat' => 22.9833, 'lng' => 120.6333],
            '內門區' => ['lat' => 22.9500, 'lng' => 120.4667],
            '杉林區' => ['lat' => 22.9500, 'lng' => 120.5500],
            '甲仙區' => ['lat' => 23.0833, 'lng' => 120.5833],
            '桃源區' => ['lat' => 23.1667, 'lng' => 120.7500],
            '那瑪夏區' => ['lat' => 23.2500, 'lng' => 120.7000],
            '茂林區' => ['lat' => 22.9167, 'lng' => 120.6667],
        ],
        // 基隆市
        '基隆市' => [
            '仁愛區' => ['lat' => 25.1333, 'lng' => 121.7500],
            '信義區' => ['lat' => 25.1167, 'lng' => 121.7667],
            '中正區' => ['lat' => 25.1500, 'lng' => 121.7667],
            '中山區' => ['lat' => 25.1500, 'lng' => 121.7333],
            '安樂區' => ['lat' => 25.1167, 'lng' => 121.7167],
            '暖暖區' => ['lat' => 25.0833, 'lng' => 121.7500],
            '七堵區' => ['lat' => 25.0833, 'lng' => 121.7000],
        ],
        // 新竹市
        '新竹市' => [
            '東區' => ['lat' => 24.8000, 'lng' => 121.0167],
            '北區' => ['lat' => 24.8167, 'lng' => 121.0000],
            '香山區' => ['lat' => 24.7667, 'lng' => 120.9500],
        ],
        // 嘉義市
        '嘉義市' => [
            '東區' => ['lat' => 23.4833, 'lng' => 120.4500],
            '西區' => ['lat' => 23.4833, 'lng' => 120.4167],
        ],
        // 南投縣
        '南投縣' => [
            '南投市' => ['lat' => 23.9167, 'lng' => 120.6833],
            '埔里鎮' => ['lat' => 23.9667, 'lng' => 120.9667],
            '草屯鎮' => ['lat' => 23.9833, 'lng' => 120.6833],
            '竹山鎮' => ['lat' => 23.7500, 'lng' => 120.6833],
            '集集鎮' => ['lat' => 23.8333, 'lng' => 120.7833],
            '名間鄉' => ['lat' => 23.8500, 'lng' => 120.7000],
            '鹿谷鄉' => ['lat' => 23.7500, 'lng' => 120.7500],
            '中寮鄉' => ['lat' => 23.9167, 'lng' => 120.7667],
            '魚池鄉' => ['lat' => 23.9000, 'lng' => 120.9167],
            '國姓鄉' => ['lat' => 24.0333, 'lng' => 120.8500],
            '水里鄉' => ['lat' => 23.8000, 'lng' => 120.8500],
            '信義鄉' => ['lat' => 23.6000, 'lng' => 120.8500],
            '仁愛鄉' => ['lat' => 24.0167, 'lng' => 121.1333],
        ],
        // 彰化縣
        '彰化縣' => [
            '彰化市' => ['lat' => 24.0833, 'lng' => 120.5333],
            '鹿港鎮' => ['lat' => 24.0500, 'lng' => 120.4333],
            '和美鎮' => ['lat' => 24.1000, 'lng' => 120.5000],
            '線西鄉' => ['lat' => 24.1333, 'lng' => 120.4667],
            '伸港鄉' => ['lat' => 24.1500, 'lng' => 120.4833],
            '福興鄉' => ['lat' => 24.0500, 'lng' => 120.4500],
            '秀水鄉' => ['lat' => 24.0333, 'lng' => 120.5000],
            '花壇鄉' => ['lat' => 24.0167, 'lng' => 120.5333],
            '芬園鄉' => ['lat' => 24.0000, 'lng' => 120.6167],
            '員林市' => ['lat' => 23.9500, 'lng' => 120.5667],
            '溪湖鎮' => ['lat' => 23.9500, 'lng' => 120.4833],
            '田中鎮' => ['lat' => 23.8500, 'lng' => 120.5833],
            '大村鄉' => ['lat' => 23.9833, 'lng' => 120.5500],
            '埔鹽鄉' => ['lat' => 24.0000, 'lng' => 120.4500],
            '埔心鄉' => ['lat' => 23.9500, 'lng' => 120.5167],
            '永靖鄉' => ['lat' => 23.9167, 'lng' => 120.5500],
            '社頭鄉' => ['lat' => 23.9000, 'lng' => 120.5833],
            '二水鄉' => ['lat' => 23.8167, 'lng' => 120.6167],
            '北斗鎮' => ['lat' => 23.8667, 'lng' => 120.5167],
            '二林鎮' => ['lat' => 23.9000, 'lng' => 120.3667],
            '田尾鄉' => ['lat' => 23.8833, 'lng' => 120.5167],
            '埤頭鄉' => ['lat' => 23.8833, 'lng' => 120.4500],
            '芳苑鄉' => ['lat' => 23.9167, 'lng' => 120.3167],
            '大城鄉' => ['lat' => 23.8500, 'lng' => 120.3000],
            '竹塘鄉' => ['lat' => 23.8500, 'lng' => 120.4167],
            '溪州鄉' => ['lat' => 23.8500, 'lng' => 120.4833],
        ],
        // 雲林縣
        '雲林縣' => [
            '斗六市' => ['lat' => 23.7000, 'lng' => 120.5333],
            '斗南鎮' => ['lat' => 23.6667, 'lng' => 120.4833],
            '虎尾鎮' => ['lat' => 23.7000, 'lng' => 120.4333],
            '西螺鎮' => ['lat' => 23.8000, 'lng' => 120.4500],
            '土庫鎮' => ['lat' => 23.6667, 'lng' => 120.4000],
            '北港鎮' => ['lat' => 23.5667, 'lng' => 120.3000],
            '古坑鄉' => ['lat' => 23.6500, 'lng' => 120.5667],
            '大埤鄉' => ['lat' => 23.6500, 'lng' => 120.4333],
            '莿桐鄉' => ['lat' => 23.7500, 'lng' => 120.5000],
            '林內鄉' => ['lat' => 23.7500, 'lng' => 120.6167],
            '二崙鄉' => ['lat' => 23.8000, 'lng' => 120.4000],
            '崙背鄉' => ['lat' => 23.7500, 'lng' => 120.3500],
            '麥寮鄉' => ['lat' => 23.7500, 'lng' => 120.2500],
            '東勢鄉' => ['lat' => 23.6667, 'lng' => 120.2500],
            '褒忠鄉' => ['lat' => 23.7000, 'lng' => 120.3000],
            '台西鄉' => ['lat' => 23.7000, 'lng' => 120.2000],
            '元長鄉' => ['lat' => 23.6500, 'lng' => 120.3167],
            '四湖鄉' => ['lat' => 23.6333, 'lng' => 120.2167],
            '口湖鄉' => ['lat' => 23.5833, 'lng' => 120.1833],
            '水林鄉' => ['lat' => 23.5667, 'lng' => 120.2500],
        ],
    ];

    /**
     * 取得指定縣市和行政區的地理中心點
     */
    public static function getCenter(string $city, string $district): ?array
    {
        return self::$geoCenters[$city][$district] ?? null;
    }

    /**
     * 取得指定縣市的所有行政區中心點
     */
    public static function getCityCenters(string $city): array
    {
        return self::$geoCenters[$city] ?? [];
    }

    /**
     * 取得所有縣市列表
     */
    public static function getCities(): array
    {
        return array_keys(self::$geoCenters);
    }

    /**
     * 取得指定縣市的所有行政區列表
     */
    public static function getDistricts(string $city): array
    {
        return array_keys(self::$geoCenters[$city] ?? []);
    }

    /**
     * 檢查縣市是否存在
     */
    public static function cityExists(string $city): bool
    {
        return isset(self::$geoCenters[$city]);
    }

    /**
     * 檢查行政區是否存在
     */
    public static function districtExists(string $city, string $district): bool
    {
        return isset(self::$geoCenters[$city][$district]);
    }

    /**
     * 取得所有地理中心點資料
     */
    public static function getAllCenters(): array
    {
        return self::$geoCenters;
    }
}
